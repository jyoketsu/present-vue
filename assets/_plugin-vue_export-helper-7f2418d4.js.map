{"version":3,"file":"_plugin-vue_export-helper-7f2418d4.js","sources":["../../src/Present.vue"],"sourcesContent":["<template>\n  <div class=\"present\" :tabindex=\"-1\" @keydown=\"handleKeyDown\">\n    <div class=\"present-item-container\" :style=\"containerStyle\">\n      <div class=\"present-item pre-present\">\n        <slot name=\"previous\">previous</slot>\n      </div>\n      <div :class=\"currentClasses\" ref=\"currentPresentRef\">\n        <slot name=\"current\">current</slot>\n      </div>\n      <div class=\"present-item next-present\">\n        <slot name=\"next\">next</slot>\n      </div>\n    </div>\n    <div\n      class=\"present-process\"\n      :style=\"`grid-template-columns: repeat(${pageCount}, 1fr);`\"\n    >\n      <div\n        v-for=\"process in processArray\"\n        class=\"process-item\"\n        :key=\"process\"\n        :style=\"`background-color:${\n          process === currentPage ? highlightProcessColor : processColor\n        }`\"\n      ></div>\n      <div class=\"pagination\" v-if=\"!hidePaginationButton\">\n        <svg\n          t=\"1688608584325\"\n          class=\"icon\"\n          viewBox=\"0 0 1024 1024\"\n          version=\"1.1\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          p-id=\"5138\"\n          width=\"40\"\n          height=\"40\"\n          @click=\"prevPage\"\n        >\n          <path\n            d=\"M719.165296 999.424L800.450704 918.124169 383.495211 501.183099 800.450704 84.242028 719.165296 2.95662 223.549296 501.183099z\"\n            fill=\"#2196F3\"\n            p-id=\"5139\"\n          ></path>\n        </svg>\n        <svg\n          t=\"1688608759763\"\n          class=\"icon\"\n          viewBox=\"0 0 1024 1024\"\n          version=\"1.1\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          p-id=\"5282\"\n          width=\"40\"\n          height=\"40\"\n          @click=\"nextPage\"\n        >\n          <path\n            d=\"M304.834704 11.812056L223.549296 93.097465l416.955493 416.955493L223.549296 926.965183l81.285408 81.299831L800.450704 510.038535z\"\n            fill=\"#2196F3\"\n            p-id=\"5283\"\n          ></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, ref, watch } from \"vue\";\nimport \"./Present.css\";\n\nconst props = withDefaults(\n  defineProps<{\n    currentPage: number;\n    pageCount: number;\n    processColor?: string;\n    highlightProcessColor?: string;\n    hidePaginationButton?: boolean;\n    scrollStep?: number;\n  }>(),\n  { processColor: \"#bcddff\", highlightProcessColor: \"#409eff\", scrollStep: 200 }\n);\n\nconst emit = defineEmits<{\n  (e: \"next\", index: number): void;\n  (e: \"previous\", index: number): void;\n}>();\n\nconst translateY = ref(-100);\nconst transition = ref(true);\nconst shake = ref(false);\nconst controllable = ref(true);\nconst currentPresentRef = ref<HTMLDivElement | null>(null);\nlet scrollTop = 0;\n\nconst containerStyle = computed(() => ({\n  transform: `translateY(${translateY.value}vh)`,\n  transition: transition.value ? \"transform 500ms\" : \"unset\",\n}));\n\nconst currentClasses = computed(() => ({\n  \"present-item\": true,\n  \"current-present\": true,\n  shake: shake.value,\n}));\n\nconst processArray = computed(() =>\n  Array(props.pageCount)\n    .fill(0)\n    .map((_, index) => index)\n);\n\nwatch(\n  () => props.currentPage,\n  () => {\n    transition.value = false;\n  }\n);\n\nwatch(transition, (newVal) => {\n  if (newVal === false) {\n    translateY.value = -100;\n  }\n});\n\nwatch(translateY, (newVal) => {\n  if (newVal === -100) {\n    setTimeout(() => {\n      transition.value = true;\n      controllable.value = true;\n    }, 200);\n  }\n});\n\nconst nextPage = () => {\n  if (!controllable.value) {\n    return;\n  }\n\n  scrollTop = 0;\n  if (currentPresentRef.value) {\n    currentPresentRef.value.scrollTop = 0;\n  }\n\n  if (props.currentPage + 1 === props.pageCount) {\n    shake.value = true;\n    setTimeout(() => {\n      shake.value = false;\n    }, 600);\n    return;\n  }\n  translateY.value -= 100;\n  controllable.value = false;\n  setTimeout(() => {\n    emit(\"next\", 1);\n  }, 500);\n};\n\nconst prevPage = () => {\n  if (!controllable.value) {\n    return;\n  }\n\n  scrollTop = 0;\n  if (currentPresentRef.value) {\n    currentPresentRef.value.scrollTop = 0;\n  }\n\n  if (props.currentPage === 0) {\n    shake.value = true;\n    setTimeout(() => {\n      shake.value = false;\n    }, 600);\n    return;\n  }\n  translateY.value += 100;\n  controllable.value = false;\n  setTimeout(() => {\n    emit(\"previous\", 1);\n  }, 500);\n};\n\nconst handleKeyDown = (e: KeyboardEvent) => {\n  if (!controllable.value) {\n    return;\n  }\n  switch (e.key) {\n    case \"ArrowRight\":\n      nextPage();\n      break;\n    case \"ArrowLeft\":\n      prevPage();\n      break;\n    case \"ArrowUp\":\n      if (currentPresentRef.value) {\n        const isAtTop = currentPresentRef.value.scrollTop === 0;\n        if (isAtTop) {\n          scrollTop = 0;\n          currentPresentRef.value.scrollTop = 0;\n          prevPage();\n        } else {\n          if (scrollTop > 0) {\n            scrollTop -= props.scrollStep;\n            currentPresentRef.value.scrollTo({\n              top: scrollTop,\n              behavior: \"smooth\",\n            });\n          }\n        }\n      }\n\n      break;\n    case \"ArrowDown\":\n      if (currentPresentRef.value) {\n        const isAtBottom =\n          currentPresentRef.value.scrollHeight -\n            currentPresentRef.value.scrollTop <=\n          currentPresentRef.value.clientHeight;\n\n        if (isAtBottom) {\n          scrollTop = 0;\n          currentPresentRef.value.scrollTop = 0;\n          nextPage();\n        } else {\n          scrollTop += props.scrollStep;\n          currentPresentRef.value.scrollTo({\n            top: scrollTop,\n            behavior: \"smooth\",\n          });\n        }\n      }\n      break;\n    default:\n      break;\n  }\n};\n</script>\n"],"names":["translateY","ref","transition","shake","controllable","currentPresentRef","scrollTop","containerStyle","computed","currentClasses","processArray","props","_","index","watch","newVal","nextPage","emit","prevPage","handleKeyDown","e"],"mappings":"82BAsFMA,EAAaC,EAAI,IAAI,EACrBC,EAAaD,EAAI,EAAI,EACrBE,EAAQF,EAAI,EAAK,EACjBG,EAAeH,EAAI,EAAI,EACvBI,EAAoBJ,EAA2B,IAAI,EACzD,IAAIK,EAAY,EAEV,MAAAC,EAAiBC,EAAS,KAAO,CACrC,UAAW,cAAcR,EAAW,WACpC,WAAYE,EAAW,MAAQ,kBAAoB,OACnD,EAAA,EAEIO,EAAiBD,EAAS,KAAO,CACrC,eAAgB,GAChB,kBAAmB,GACnB,MAAOL,EAAM,KACb,EAAA,EAEIO,EAAeF,EAAS,IAC5B,MAAMG,EAAM,SAAS,EAClB,KAAK,CAAC,EACN,IAAI,CAACC,EAAGC,IAAUA,CAAK,CAAA,EAG5BC,EACE,IAAMH,EAAM,YACZ,IAAM,CACJT,EAAW,MAAQ,EACrB,CAAA,EAGIY,EAAAZ,EAAaa,GAAW,CACxBA,IAAW,KACbf,EAAW,MAAQ,KACrB,CACD,EAEKc,EAAAd,EAAae,GAAW,CACxBA,IAAW,MACb,WAAW,IAAM,CACfb,EAAW,MAAQ,GACnBE,EAAa,MAAQ,IACpB,GAAG,CACR,CACD,EAED,MAAMY,EAAW,IAAM,CACjB,GAACZ,EAAa,MASlB,IALYE,EAAA,EACRD,EAAkB,QACpBA,EAAkB,MAAM,UAAY,GAGlCM,EAAM,YAAc,IAAMA,EAAM,UAAW,CAC7CR,EAAM,MAAQ,GACd,WAAW,IAAM,CACfA,EAAM,MAAQ,IACb,GAAG,EACN,OAEFH,EAAW,OAAS,IACpBI,EAAa,MAAQ,GACrB,WAAW,IAAM,CACfa,EAAK,OAAQ,CAAC,GACb,GAAG,EAAA,EAGFC,EAAW,IAAM,CACjB,GAACd,EAAa,MASd,IALQE,EAAA,EACRD,EAAkB,QACpBA,EAAkB,MAAM,UAAY,GAGlCM,EAAM,cAAgB,EAAG,CAC3BR,EAAM,MAAQ,GACd,WAAW,IAAM,CACfA,EAAM,MAAQ,IACb,GAAG,EACN,OAEFH,EAAW,OAAS,IACpBI,EAAa,MAAQ,GACrB,WAAW,IAAM,CACfa,EAAK,WAAY,CAAC,GACjB,GAAG,EAAA,EAGFE,EAAiBC,GAAqB,CACtC,GAAChB,EAAa,MAGlB,OAAQgB,EAAE,IAAK,CACb,IAAK,aACMJ,IACT,MACF,IAAK,YACME,IACT,MACF,IAAK,UACCb,EAAkB,QACJA,EAAkB,MAAM,YAAc,GAExCC,EAAA,EACZD,EAAkB,MAAM,UAAY,EAC3Ba,KAELZ,EAAY,IACdA,GAAaK,EAAM,WACnBN,EAAkB,MAAM,SAAS,CAC/B,IAAKC,EACL,SAAU,QAAA,CACX,IAKP,MACF,IAAK,YACCD,EAAkB,QAElBA,EAAkB,MAAM,aACtBA,EAAkB,MAAM,WAC1BA,EAAkB,MAAM,cAGZC,EAAA,EACZD,EAAkB,MAAM,UAAY,EAC3BW,MAETV,GAAaK,EAAM,WACnBN,EAAkB,MAAM,SAAS,CAC/B,IAAKC,EACL,SAAU,QAAA,CACX,IAGL,KAGJ,CAAA"}